<app-header-component></app-header-component>
<main>
    <section class="sidebar">
        <ul class="ActionListWrap">
            <ng-container *ngIf="listTypesArray">
                <ng-container *ngFor="let listType of listTypesArray">
                    <li class="ActionListItem ActionListItem--navActive"
                    (click)="activeType = listType" [class.active-tab]="listType.value === activeType.value">
                    <a class="ActionListContent ActionListContent--visual16">
                        <span class="ActionListItem-visual ActionListItem-visual--leading">
                            <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16"
                                data-view-component="true" class="octicon octicon-person">
                                <path
                                    d="M10.561 8.073a6.005 6.005 0 0 1 3.432 5.142.75.75 0 1 1-1.498.07 4.5 4.5 0 0 0-8.99 0 .75.75 0 0 1-1.498-.07 6.004 6.004 0 0 1 3.431-5.142 3.999 3.999 0 1 1 5.123 0ZM10.5 5a2.5 2.5 0 1 0-5 0 2.5 2.5 0 0 0 5 0Z">
                                </path>
                            </svg>
                        </span>
                        <span class="ActionListItem-label">
                            {{listType.label}}
                        </span></a>
                </li>
                </ng-container>
            </ng-container>
            <li class="ActionListItem">
        </ul>
    </section>

    <section class="main-wrapper">
        <ng-container [ngSwitch]="activeType.value">
            <ng-container *ngSwitchCase="'userProfile'">
                <form  *ngIf="userForm?.controls">
                    <h2 id="public-profile-heading" class="Subhead-heading">Your profile</h2>
                    <div class="inputContainer">
                        <app-text-box [placeholder]="'Username'" [formControl]="userForm.controls['username']"></app-text-box>
                        <!-- надо залочить -->
                    </div>
                    <div class="inputContainer">
                        <app-text-box [placeholder]="'full_name'" [formControl]="userForm.controls['fullName']"></app-text-box>
                        <p id="confirmnote"
                            *ngIf="userForm.controls['fullName'].value?.length>0 && userForm.controls['fullName'].value?.length < 10 && !userForm.controls['phone'].value?.match(FULLNAME_REGEX)">
                            must be at least 10 characters long
                        </p>
                    </div>
                    <div class="inputContainer">
                        <app-text-box [placeholder]="'phone'" [formControl]="userForm.controls['phone']"></app-text-box>
                        <p id="confirmnote"
                            *ngIf="userForm.controls['phone'].value?.length>0 && !userForm.controls['phone'].value?.match(PHONE_REGEX)">
                            contact phone matching +xxxxxxxxxxxx
                        </p>
                    </div>
                    <div class="inputContainer">
                        <app-text-box [placeholder]="'your password'" [isPassword]="true"
                            [formControl]="userForm.controls['password']"></app-text-box>
                    </div>
                    <div class="inputContainer">
                        <app-text-box [placeholder]="'new password'" [isPassword]="true"
                            [formControl]="userForm.controls['new_password']"></app-text-box>
                        <p id="pwdnote"
                            *ngIf="userForm.controls['new_password'].value?.length>0 && !userForm.controls['new_password'].value?.match(PWD_REGEX)">
                            must be at least 8 characters long, must include uppercase letter, number, and a special character
                            (!@#$%^&*)
                        </p>
                    </div>
                    <div class="inputContainer">
                        <app-text-box [placeholder]="'confirm password'" [isPassword]="true"
                            [formControl]="userForm.controls['confirm_password']"></app-text-box>
                        <p id="confirmnote"
                            *ngIf="userForm.controls['confirm_password'].value?.length > 0 && userForm.controls['confirm_password'].value !== userForm.controls['new_password'].value">
                            must match the new password input field
                        </p>
                    </div>
                    <button type="button" (click)="changeUserData(userForm.value)" class="button"
                        [disabled]="!isValidUserForm()">
                        Save changes
                    </button>
                </form>
            </ng-container>
            <form *ngSwitchCase="'yourBookings' || 'bookings'">
                <app-text-box [placeholder]="'Booking ID'" [formControl]="searchForm.controls['search']"></app-text-box>
                <table>
                    <thead>
                        <tr>
                            <th>Booking Id</th>
                            <th>Trip number</th>
                            <th>Bus Brand</th>
                            <th>Quantity of Seats</th>
                            <th>Arrival point</th>
                            <th>Journey Date</th>
                            <th>Departure Time</th>
                            <th>Booking Status</th>
                            <th></th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor="let booking of filteredBookings" (click)="selectBooking(booking)"
                            [class.active]="this.selectedBooking === booking">
                            <td>{{ booking.booking_id }}</td>
                            <td>{{ booking.trip_number }}</td>
                            <td>{{ booking.bus_brand }}</td>
                            <td>{{ booking.quantity_of_seats }}</td>
                            <td>{{ booking.arrival_point }}</td>
                            <td>{{ booking.journey_date | date:'yyyy-MM-dd' }}</td>
                            <td>{{ booking.departure_time }}</td>
                            <td>{{ booking.booking_status }}</td>
                            <td>
                                <div>
                                    <button type="button" class="button" *ngIf="booking.booking_status === 'Active' && userInfo.role !== 'cashier'"
                                     (click)="deleteBooking()">Сancel</button>
                                </div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </form>
            <form *ngSwitchCase="'sellTickets'">
                <app-text-box [placeholder]="'Ticket ID'" [formControl]="searchForm.controls['search']"></app-text-box>
                <table>
                    <thead>
                        <tr>
                            <th>Ticket Id</th>
                            <th>Journey Id</th>
                            <th>Arrival point</th>
                            <th>Journey Date</th>
                            <th>Client login</th>
                            <th>Ticket Status</th>
                            <th></th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor="let booking of filteredBookings" (click)="selectBooking(booking)"
                            [class.active]="isSelected(booking)">
                            <td>{{ booking.ticket_id }}</td>
                            <td>{{ booking.journey_id }}</td>
                            <td>{{ booking.arrival_point }}</td>
                            <td>{{ booking.journey_date | date:'yyyy-MM-dd' }}</td>
                            <td>{{ booking.login }}</td>
                            <td>{{ booking.ticket_status }}</td>
                            <td>
                                <div>
                                    <button type="button" class="button" (click)="sellTicket(booking.ticket_id)"> Pay
                                    </button>
                                </div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </form>
        </ng-container>
    </section>
</main>